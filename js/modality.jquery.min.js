/* @author: Mark McCann (www.markmccann.me) @license: None, Public Domain */
!function(e,n,t,s){var i="modality",r=e("body")[0],a={autoBind:!0,clickOffToClose:!0,closeOnEscape:!0,effect:"",enabled:!0,innerClass:"mm-wrap",modalClass:"modality-modal",onClose:"",onOpen:"",openClass:"mm-show",openOnLoad:!1,userClass:""},o=function(e){for(var n=0;n<e.length;n++)"function"==typeof e[n]&&e[n]()},l=function(e,n){return""!=e[n]?" "+e[n]:""},d=function(e,n){for(var t=e.length;t--;)if(e[t][0]===n)return t;return!1},c=function(e){return e===parseInt(e,10)},u=function(n,t){var s=this,i=e(n).attr("id"),o=e.extend({},a,t),d=e(n).wrap('<div class="'+o.modalClass+l(o,"effect")+l(o,"userClass")+'"><div class="'+o.innerClass+'"></div></div>').show(),c=d.parents("."+o.modalClass);return $triggers=e('a[href="#'+i+'"], [data-modality="#'+i+'"]'),e.extend(s,{defaults:a,id:i,settings:o,$wrapper:c,$triggers:[],$modal:d}),o.autoBind&&$triggers.each(function(){s.addTrigger(e(this))}),o.clickOffToClose&&c.click(function(e){e.preventDefault(),e.target==s.$wrapper[0]&&s.close()}),o.closeOnEscape&&e(r).keyup(function(e){27==e.keyCode&&s.close()}),-1!=navigator.appVersion.indexOf("MSIE 7.")&&c.prepend('<div class="mm-ghost"></div>'),o.openOnLoad&&s.open(),s};e.extend(u.prototype,{open:function(e){return this.$wrapper.add(r).addClass(this.settings.openClass),o([this.settings.onOpen,e]),this},close:function(e){return this.$wrapper.add(r).removeClass(this.settings.openClass),o([this.settings.onClose,e]),this},toggle:function(e){return this.isOpen()?this.close(e):this.open(e)},isOpen:function(){return this.$wrapper.hasClass(this.settings.openClass)},addTrigger:function(e){var n=this,t=n.$triggers,s=d(t,e),i=[e,function(e){e.preventDefault(),n.toggle()}];return c(s)?t[s]=i:t.push(i),n.settings.enabled&&i[0].bind("click",i[1]),n},removeTrigger:function(e){var n=this,t=n.$triggers,s=d(t,e);return c(s)&&t[s].length>1&&(t[s][0].unbind("click",t[s][1]),t[s].splice(1,1)),n},enable:function(){var e=this,n=e.$triggers,t=n.length;if(!e.settings.enabled){e.settings.enabled=!0;for(var s=0;t>s;s++)e.addTrigger(n[s][0])}return e},disable:function(){var e=this,n=e.$triggers,t=n.length;if(e.settings.enabled){e.settings.enabled=!1;for(var s=0;t>s;s++)e.removeTrigger(n[s][0])}return e}}),e.extend(u,{instances:{},init:function(e,n){var t={},i=this,r=0;return e.each(function(){var e=new i(this,n);i.instances[e.id]=t[r]=e}),t[1]===s?t[0]:t}}),e[i]=u,e.fn[i]=function(n){return e[i].init(this,n)}}(jQuery,window,document);
