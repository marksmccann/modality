/* @author: Mark McCann (www.markmccann.me) @license: None, Public Domain */
;(function(e,t,n,r){function u(t,n,r){var u=this;u._defaults=o;u._name=i;u.element=t;u._$body=s;u.id=e(t).attr("id");u.settings=e.extend({},o,n);u.$element=e(t).wrap('<div class="'+u.settings.modalClass+" "+u.settings.effect+" "+u.settings.userClass+'">'+'<div class="'+u.settings.innerClass+'">'+"</div>"+"</div>").show();u.$wrapper=u.$element.parents("."+u.settings.modalClass);u.$triggers=e('a[href="#'+u.id+'"], [data-modality="#'+u.id+'"]');if(navigator.appVersion.indexOf("MSIE 7.")!=-1){u.$wrapper.prepend('<div class="mm-ghost"></div>')}if(u.settings.autoBind){u.$triggers.each(function(){u.setTrigger(e(this))})}if(u.settings.clickOffToClose){u.$wrapper.click(function(e){e.preventDefault();if(e.target==u.$wrapper[0])u.close()})}if(u.settings.closeOnEscape){u._$body.keyup(function(e){if(e.keyCode==27)u.close()})}if(u.settings.openOnLoad)u.open();if(typeof r=="function")r();return e.modality.lookup[u.id]=u}var i="modality",s=e("body"),o={modalClass:"modality-modal",innerClass:"mm-wrap",openClass:"mm-show",userClass:"",clickOffToClose:true,closeOnEscape:true,openOnLoad:false,autoBind:true,effect:"effect-1",onOpen:function(){},onClose:function(){}};e.extend(u.prototype,{open:function(){this.$wrapper.add(this._$body).addClass(this.settings.openClass);if(typeof this.settings.onOpen=="function")this.settings.onOpen();return this},close:function(){this.$wrapper.add(this._$body).removeClass(this.settings.openClass);if(typeof this.settings.onClose=="function")this.settings.onClose();return this},toggle:function(){return this.isOpen()?this.close():this.open()},isOpen:function(){return this.$wrapper.hasClass(this.settings.openClass)},setTrigger:function(e){var t=this;e.click(function(e){e.preventDefault();t.toggle()});return t}});e[i]=u;e[i].lookup=[];e.fn[i]=function(t){this.each(function(){if(!e.data(this,"plugin_"+i)){e.data(this,"plugin_"+i,new u(this,t))}});return this}})(jQuery,window,document)