/* @author: Mark McCann (www.markmccann.me) @license: None, Public Domain */
!function(n,e,t,s){var i="modality",r=n("body")[0],a="click",o={autoBind:!0,clickOffToClose:!0,closeOnEscape:!0,effect:"",enabled:!0,innerClass:"mm-wrap",modalClass:"modality-modal",onClose:"",onOpen:"",openClass:"mm-show",openOnLoad:!1,userClass:""},l=function(n){for(var e=0;e<n.length;e++)"function"==typeof n[e]&&n[e]()},d=function(n,e){return""!=n[e]?" "+n[e]:""},u=function(n,e){for(var t=n.length;t--;)if(n[t][0][0]===e[0])return t;return!1},c=function(n){return n===parseInt(n,10)},f=function(e,t){var s=this,i=n(e).attr("id"),a=n.extend({},o,t),l=n(e).wrap('<div class="'+a.modalClass+d(a,"effect")+d(a,"userClass")+'"><div class="'+a.innerClass+'"></div></div>').show(),u=l.parents("."+a.modalClass);return triggers=n('a[href="#'+i+'"], [data-modality="#'+i+'"]'),n.extend(s,{defaults:o,id:i,settings:a,wrapper:u,triggers:[],modal:l}),a.autoBind&&triggers.each(function(){s.addTrigger(n(this))}),a.clickOffToClose&&u.click(function(n){n.preventDefault(),n.target==s.wrapper[0]&&s.close()}),a.closeOnEscape&&n(r).keyup(function(n){27==n.keyCode&&s.close()}),-1!=navigator.appVersion.indexOf("MSIE 7.")&&u.prepend('<div class="mm-ghost"></div>'),a.openOnLoad&&s.open(),s};n.extend(f.prototype,{open:function(n){return this.wrapper.add(r).addClass(this.settings.openClass),l([this.settings.onOpen,n]),this},close:function(n){return this.wrapper.add(r).removeClass(this.settings.openClass),l([this.settings.onClose,n]),this},toggle:function(n){return this.isOpen()?this.close(n):this.open(n)},isOpen:function(){return this.wrapper.hasClass(this.settings.openClass)},addTrigger:function(n){var e=this,t=e.triggers,s=u(t,n),i=[n,function(n){n.preventDefault(),e.toggle()}];return c(s)?t[s]=i:t.push(i),e.settings.enabled&&i[0].bind(a,i[1]),e},removeTrigger:function(n){var e=this,t=e.triggers,s=u(t,n);return c(s)&&(t[s][0].unbind(a,t[s][1]),t.splice(s,1)),e},enable:function(){var n=this,e=n.triggers,t=e.length;if(!n.settings.enabled){n.settings.enabled=!0;for(var s=0;t>s;s++)e[s][0].bind(a,e[s][1])}return n},disable:function(){var n=this,e=n.triggers,t=e.length;if(n.settings.enabled){n.settings.enabled=!1;for(var s=0;t>s;s++)e[s][0].unbind(a,e[s][1])}return n}}),n.extend(f,{instances:{},init:function(n,e){var t={},i=this,r=0;return n.each(function(){var n=new i(this,e);i.instances[n.id]=t[r]=n}),t[1]===s?t[0]:t}}),n[i]=f,n.fn[i]=function(e){return n[i].init(this,e)}}(jQuery,window,document);
