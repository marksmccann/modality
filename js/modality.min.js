/* @author: Mark McCann (www.markmccann.me) @license: None, Public Domain */
;var Modality=function(){var e=document.getElementsByTagName("body")[0],t={autoBind:true,clickOffToClose:true,closeOnEscape:true,effect:"",innerClass:"mm-wrap",modalClass:"modality-modal",onClose:"",onOpen:"",openClass:"mm-show",openOnLoad:false,userClass:""},n=function(e,t,n){if(e.attachEvent){e["e"+t+n]=n;e[t+n]=function(){e["e"+t+n](window.event)};e.attachEvent("on"+t,e[t+n])}else{e.addEventListener(t,n,false)}},r=function(e,t){var n=document.createElement("div");n.setAttribute("class",t.modalClass+" "+t.effect+" "+t.userClass);n.innerHTML='<div class="'+t.innerClass+'">'+e.outerHTML+"</div>";e.parentNode.replaceChild(n,e);return n},i=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},s=function(e,t){if(Array.isArray(e)){for(var n=0;n<e.length;n++){s(e[n],t)}}else{if(!i(e,t)){e.className+=" "+t}}},o=function(e,t){if(Array.isArray(e)){for(var n=0;n<e.length;n++){o(e[n],t)}}else{if(i(e,t)){var r=new RegExp("(\\s|^)"+t+"(\\s|$)","g");e.className=e.className.replace(r,"")}}},u=function(i,s,o){var a=this;a._body=e;a._defaults=t;a.id=i.getAttribute("id");a.settings=u.extend({},t,s);a.wrapper=r(i,a.settings);a.triggers=document.querySelectorAll('a[href="#'+a.id+'"], [data-modality="#'+a.id+'"]');a.element=document.getElementById(a.id);if(a.settings.autoBind){for(var f=0;f<a.triggers.length;f++)a.setTrigger(a.triggers[f])}if(a.settings.clickOffToClose){n(a.wrapper,"click",function(e){e.preventDefault();if(e.target==a.wrapper)a.close()},false)}if(a.settings.closeOnEscape){n(a._body,"keyup",function(e){if(e.keyCode==27)a.close()},false)}if(a.element.style.display=="none")a.element.style.display="";if(a.settings.openOnLoad)a.open();if(typeof o=="function")o();return u.lookup[a.id]=a};u.extend(u.prototype,{open:function(e){s([this.wrapper,this._body],this.settings.openClass);if(typeof this.settings.onOpen=="function")this.settings.onOpen();if(typeof e=="function")e();return this},close:function(e){o([this.wrapper,this._body],this.settings.openClass);if(typeof this.settings.onClose=="function")this.settings.onClose();if(typeof e=="function")e();return this},toggle:function(e){return this.isOpen()?this.close(e):this.open(e)},isOpen:function(){return i(this.wrapper,this.settings.openClass)},setTrigger:function(e){var t=this;n(e,"click",function(e){e.preventDefault();t.toggle()},false);return this}});u.init=function(e,t,n){var r=document.querySelectorAll(e);for(var i=0;i<r.length;i++){var s=new u(r[i],t,n);if(r.length==1){return s}}return u.lookup};u.extend=function(){var e=arguments;for(var t=1;t<e.length;t++)for(var n in e[t])if(e[t].hasOwnProperty(n))e[0][n]=e[t][n];return e[0]};u.lookup={};return u}();
