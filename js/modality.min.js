/* @author: Mark McCann (www.markmccann.me) @license: None, Public Domain */
!function(){var e="Modality",t=document,n=t.querySelector("body"),r="click",i="className",o="triggers",a="settings",s={bind:!0,"class":"",clickoff:!0,effect:"",enabled:!0,keyboard:!0,open:!1,onClose:"",onOpen:"",inner:"mm-wrap",visible:"mm-show",outer:"modality-modal"},u=function(){for(var e=arguments,t=1;t<e.length;t++)for(var n in e[t])e[t].hasOwnProperty(n)&&(e[0][n]=e[t][n]);return e[0]},l=function(e,t,n){e.attachEvent?(e["e"+t+n]=n,e[t+n]=function(){e["e"+t+n](window.event)},e.attachEvent("on"+t,e[t+n])):e.addEventListener(t,n,!1)},c=function(e,t,n){e.detachEvent?(e.detachEvent("on"+t,e[t+n]),e[t+n]=null):e.removeEventListener(t,n,!1)},f=function(e){for(var t=0;t<e.length;t++)"function"==typeof e[t]&&e[t]()},d=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},v=function(e,t){return e[i].match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},h=function(e,t){for(var n=0;n<e.length;n++)v(e[n],t)||(e[n][i]+=0==e[n][i].length?t:" "+t)},p=function(e,t){for(var n=0;n<e.length;n++)if(v(e[n],t)){var r=new RegExp("(\\s|^)"+t+"(\\s|$)","g");e[n][i]=e[n][i].replace(r,"")}},g=function(e,t){for(var n=e.length;n--;)if(e[n][0]===t)return n;return!1},b=function(e){return e===parseInt(e,10)},y=function(e){switch(e.toLowerCase()){case"false":case"no":case"0":case"":return!1;default:return!0}},m=function(e,t){return""!=e[t]?" "+e[t]:""},w=function(e,n){var r=t.createElement("div");return r.setAttribute("class",n.outer+m(n,"effect")+m(n,"class")),r.innerHTML='<div class="'+n.inner+'">'+e.outerHTML+"</div>",e.parentNode.replaceChild(r,e),r},E=function(e,t){for(var n in e)t[n]="boolean"==typeof t[n]?y(e[n]):e[n];return t},k=function(e,i){var o=this,a=e.getAttribute("id"),c=E(e.dataset,u({},s,i)),f=w(e,c),d=t.querySelectorAll('a[href="#'+a+'"], [data-target="#'+a+'"]'),v=t.getElementById(a);if(u(o,{defaults:s,id:a,settings:c,wrapper:f,triggers:[],modal:v}),c.bind)for(var h=0;h<d.length;h++)o.addTrigger(d[h]);return c.clickoff&&(l(f,r,function(){o.close()}),l(v,r,function(e){e.stopPropagation()})),c.keyboard&&l(n,"keyup",function(e){27==e.keyCode&&o.close()}),"none"==v.style.display&&(v.style.display=""),c.open&&o.open(),o};u(k.prototype,{open:function(e){return h([this.wrapper,n],this[a].visible),f([this[a].onOpen,e]),this},close:function(e){return p([this.wrapper,n],this[a].visible),f([this[a].onClose,e]),this},toggle:function(e){return this.isOpen()?this.close(e):this.open(e)},isOpen:function(){return v(this.wrapper,this[a].visible)},addTrigger:function(e){var t=this,n=t[o],i=g(n,e),s=[e,function(e){d(e),t.toggle()}];return b(i)?n[i]=s:n.push(s),t[a].enabled&&l(s[0],r,s[1]),t},removeTrigger:function(e){var t=this,n=t[o],i=g(n,e);return b(i)&&(c(n[i][0],r,n[i][1]),n.splice(i,1)),t},enable:function(){var e=this,t=e[o],n=t.length;if(!e[a].enabled){e[a].enabled=!0;for(var i=0;n>i;i++)l(t[i][0],r,t[i][1])}return e},disable:function(){var e=this,t=e[o],n=t.length;if(e[a].enabled){e[a].enabled=!1;for(var i=0;n>i;i++)c(t[i][0],r,t[i][1])}return e}}),u(k,{instances:{},extend:u,init:function(e,n){for(var r=this,i=r.instances,o={},a=t.querySelectorAll(e),s=0;s<a.length;s++){var u=a[s].getAttribute("id");void 0==i[u]&&(i[u]=o[s]=new r(a[s],n))}return void 0===o[1]?o[0]:o}}),function(){for(var e=t.querySelectorAll('[data-modality="auto"]'),n=0;n<e.length;n++){var r=e[n].getAttribute("id");void 0!=r&&k.init("#"+r)}}(),window[e]=k}();