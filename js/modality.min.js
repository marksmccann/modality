/* @author: Mark McCann (www.markmccann.me) @license: None, Public Domain */
!function(e,n){var t="Modality",r=n.querySelector("body"),i="accessible",o="aria-hidden",a="click",u="tabindex",c="length",s="overflow",f="settings",l="style",d="triggers",p="wrapper",v={accessible:!0,bind:!0,"class":"",clickoff:!0,effect:"",enabled:!0,keyboard:!0,open:!1,onClose:"",onOpen:"",inner:"modality-inner",outer:"modality-outer"},g=function(n,t,r){n.attachEvent?(n["e"+t+r]=r,n[t+r]=function(){n["e"+t+r](e.event)},n.attachEvent("on"+t,n[t+r])):n.addEventListener(t,r,!1)},h=function(e){"function"==typeof e&&e()},y=function(e,n){return""!=e[n]?" "+e[n]:""},b=function(e,n){for(var t=e[c];t--;)if(e[t][0]===n)return t;return!1},m=function(e,n){for(var t in e)n[t]="boolean"==typeof n[t]?A(e[t]):e[t];return n},k=function(){var e,n=1,t=arguments;for(n;n<t[c];n++)for(e in t[n])t[n].hasOwnProperty(e)&&(t[0][e]=t[n][e]);return t[0]},w=function(e,n){return e.getAttribute(n)},E=function(e){return e===parseInt(e,10)},C=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},O=function(e,n,t){e.detachEvent?(e.detachEvent("on"+n,e[n+t]),e[n+t]=null):e.removeEventListener(n,t,!1)},T=function(e,n,t){e.setAttribute(n,t)},A=function(e){switch(e.toLowerCase()){case"false":case"no":case"0":case"":return!1;default:return!0}},L=function(e,t){var r=n.createElement("div");return T(r,"class",t.outer+y(t,"effect")+y(t,"class")),T(r,o,"true"),r.innerHTML='<div class="'+t.inner+'">'+e.outerHTML+"</div>",e.parentNode.replaceChild(r,e),r},q=function(e,t){var o=0,u=this,s=w(e,"id"),f=m(e.dataset,k({},v,t)),d=L(e,f),p=n.querySelectorAll('a[href="#'+s+'"],[data-target="#'+s+'"]'),h=n.getElementById(s);if(k(u,{id:s,settings:f,wrapper:d,triggers:[],modal:h,triggered:{}}),f.bind)for(o;o<p[c];o++)u.addTrigger(p[o]);return f.clickoff&&g(d,a,function(e){e.target==d&&u.close()}),f.keyboard&&g(r,"keyup",function(e){e.keyCode&&27!==e.keyCode||u.close()}),f[i]&&g(r,"keyup",function(e){u.isOpen()&&!h.contains(n.activeElement)&&(e.stopPropagation(),h.focus())}),"none"==h[l].display&&(h[l].display=""),f.open&&u.open(),u};k(q.prototype,{open:function(e){var n=this;return r[l][s]="hidden",T(n[p],o,"false"),n[f][i]&&(T(n.modal,u,"0"),setTimeout(function(){n.modal.focus()},25)),h(n[f].onOpen),h(e),n},close:function(e){var n=this;return r[l][s]="",T(n[p],o,"true"),n[f][i]&&(T(n.modal,u,"-1"),n.triggered.focus()),h(n[f].onClose),h(e),n},toggle:function(e){return this.isOpen()?this.close(e):this.open(e)},isOpen:function(){return"true"==w(this[p],o)?!1:!0},addTrigger:function(e){var n=this,t=n[d],r=b(t,e),i=[e,function(t){C(t),n.toggle().triggered=e}];return E(r)?t[r]=i:t.push(i),n[f].enabled&&g(i[0],a,i[1]),n},removeTrigger:function(e){var n=this,t=n[d],r=b(t,e);return E(r)&&(O(t[r][0],a,t[r][1]),t.splice(r,1)),n},enable:function(){var e=0,n=this,t=n[d],r=t[c];if(!n[f].enabled)for(n[f].enabled=!0,e;r>e;e++)g(t[e][0],a,t[e][1]);return n},disable:function(){var e=0,n=this,t=n[d],r=t[c];if(n[f].enabled)for(n[f].enabled=!1,e;r>e;e++)O(t[e][0],a,t[e][1]);return n}}),k(q,{instances:{},extend:k,init:function(e,t){var r,i=0,o={},a=this,u=a.instances,s=n.querySelectorAll(e);for(i;i<s[c];i++)r=w(s[i],"id"),r in u||(u[r]=o[i]=new a(s[i],t));return void 0===o[1]?o[0]:o}}),function(){var e,t=0,r=n.querySelectorAll('[data-modality="auto"]');for(t;t<r[c];t++)e=w(r[t],"id"),void 0!=e&&q.init("#"+e)}(),e[t]=q}(window,document);