/* @author: Mark McCann (www.markmccann.me) @license: None, Public Domain */
!function(){var e="Modality",n=document.querySelector("body"),t={autoBind:!0,clickOffToClose:!0,closeOnEscape:!0,effect:"",enabled:!0,innerClass:"mm-wrap",modalClass:"modality-modal",onClose:"",onOpen:"",openClass:"mm-show",openOnLoad:!1,userClass:""},r=function(){for(var e=arguments,n=1;n<e.length;n++)for(var t in e[n])e[n].hasOwnProperty(t)&&(e[0][t]=e[n][t]);return e[0]},s=function(e,n,t){e.attachEvent?(e["e"+n+t]=t,e[n+t]=function(){e["e"+n+t](window.event)},e.attachEvent("on"+n,e[n+t])):e.addEventListener(n,t,!1)},i=function(e,n,t){e.detachEvent?(e.detachEvent("on"+n,e[n+t]),e[n+t]=null):e.removeEventListener(n,t,!1)},o=function(e){for(var n=0;n<e.length;n++)"function"==typeof e[n]&&e[n]()},a=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},l=function(e,n){return e.className.match(new RegExp("(\\s|^)"+n+"(\\s|$)"))},c=function(e,n){for(var t=0;t<e.length;t++)l(e[t],n)||(e[t].className+=" "+n)},u=function(e,n){for(var t=0;t<e.length;t++)if(l(e[t],n)){var r=new RegExp("(\\s|^)"+n+"(\\s|$)","g");e[t].className=e[t].className.replace(r,"")}},f=function(e,n){for(var t=e.length;t--;)if(e[t][0]===n)return t;return!1},d=function(e){return e===parseInt(e,10)},g=function(e,n){return""!=e[n]?" "+e[n]:""},p=function(e,n){var t=document.createElement("div");return t.setAttribute("class",n.modalClass+g(n,"effect")+g(n,"userClass")),t.innerHTML='<div class="'+n.innerClass+'">'+e.outerHTML+"</div>",e.parentNode.replaceChild(t,e),t},h=function(e,i){var o=this,l=e.getAttribute("id"),c=r({},t,i),u=p(e,c),f=document.querySelectorAll('a[href="#'+l+'"], [data-modality="#'+l+'"]'),d=document.getElementById(l);if(r(o,{defaults:t,id:l,settings:c,wrapper:u,triggers:[],modal:d}),c.autoBind)for(var g=0;g<f.length;g++)o.addTrigger(f[g]);return c.clickOffToClose&&s(u,"click",function(e){a(e),e.target==u&&o.close()}),c.closeOnEscape&&s(n,"keyup",function(e){27==e.keyCode&&o.close()}),"none"==d.style.display&&(d.style.display=""),c.openOnLoad&&o.open(),o};r(h.prototype,{open:function(e){return c([this.wrapper,n],this.settings.openClass),o([this.settings.onOpen,e]),this},close:function(e){return u([this.wrapper,n],this.settings.openClass),o([this.settings.onClose,e]),this},toggle:function(e){return this.isOpen()?this.close(e):this.open(e)},isOpen:function(){return l(this.wrapper,this.settings.openClass)},addTrigger:function(e){var n=this,t=n.triggers,r=f(t,e),i=[e,function(e){a(e),n.toggle()}];return d(r)?t[r]=i:t.push(i),n.settings.enabled&&s(i[0],"click",i[1]),n},removeTrigger:function(e){var n=this,t=n.triggers,r=f(t,e);return d(r)&&t[r].length>1&&(i(t[r][0],"click",t[r][1]),t[r].splice(1,1)),n},enable:function(){var e=this,n=e.triggers,t=n.length;if(!e.settings.enabled){e.settings.enabled=!0;for(var r=0;t>r;r++)e.addTrigger(n[r][0])}return e},disable:function(){var e=this,n=e.triggers,t=n.length;if(e.settings.enabled){e.settings.enabled=!1;for(var r=0;t>r;r++)e.removeTrigger(n[r][0])}return e}}),r(h,{instances:{},extend:r,init:function(e,n){for(var t={},r=document.querySelectorAll(e),s=0;s<r.length;s++){var i=new this(r[s],n);this.instances[i.id]=t[s]=i}return void 0===t[1]?t[0]:t}}),window[e]=h}();
