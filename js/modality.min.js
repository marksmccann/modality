/* @author: Mark McCann (www.markmccann.me) @license: None, Public Domain */
!function(){var e="Modality",n=document.querySelector("body"),t="click",r={autoBind:!0,clickOffToClose:!0,closeOnEscape:!0,effect:"",enabled:!0,innerClass:"mm-wrap",modalClass:"modality-modal",onClose:"",onOpen:"",openClass:"mm-show",openOnLoad:!1,userClass:""},s=function(){for(var e=arguments,n=1;n<e.length;n++)for(var t in e[n])e[n].hasOwnProperty(t)&&(e[0][t]=e[n][t]);return e[0]},i=function(e,n,t){e.attachEvent?(e["e"+n+t]=t,e[n+t]=function(){e["e"+n+t](window.event)},e.attachEvent("on"+n,e[n+t])):e.addEventListener(n,t,!1)},o=function(e,n,t){e.detachEvent?(e.detachEvent("on"+n,e[n+t]),e[n+t]=null):e.removeEventListener(n,t,!1)},a=function(e){for(var n=0;n<e.length;n++)"function"==typeof e[n]&&e[n]()},l=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},c=function(e,n){return e.className.match(new RegExp("(\\s|^)"+n+"(\\s|$)"))},u=function(e,n){for(var t=0;t<e.length;t++)c(e[t],n)||(e[t].className+=" "+n)},f=function(e,n){for(var t=0;t<e.length;t++)if(c(e[t],n)){var r=new RegExp("(\\s|^)"+n+"(\\s|$)","g");e[t].className=e[t].className.replace(r,"")}},d=function(e,n){for(var t=e.length;t--;)if(e[t][0]===n)return t;return!1},g=function(e){return e===parseInt(e,10)},p=function(e,n){return""!=e[n]?" "+e[n]:""},h=function(e,n){var t=document.createElement("div");return t.setAttribute("class",n.modalClass+p(n,"effect")+p(n,"userClass")),t.innerHTML='<div class="'+n.innerClass+'">'+e.outerHTML+"</div>",e.parentNode.replaceChild(t,e),t},v=function(e,t){var o=this,a=e.getAttribute("id"),c=s({},r,t),u=h(e,c),f=document.querySelectorAll('a[href="#'+a+'"], [data-modality="#'+a+'"]'),d=document.getElementById(a);if(s(o,{defaults:r,id:a,settings:c,wrapper:u,triggers:[],modal:d}),c.autoBind)for(var g=0;g<f.length;g++)o.addTrigger(f[g]);return c.clickOffToClose&&i(u,"click",function(e){l(e),e.target==u&&o.close()}),c.closeOnEscape&&i(n,"keyup",function(e){27==e.keyCode&&o.close()}),"none"==d.style.display&&(d.style.display=""),c.openOnLoad&&o.open(),o};s(v.prototype,{open:function(e){return u([this.wrapper,n],this.settings.openClass),a([this.settings.onOpen,e]),this},close:function(e){return f([this.wrapper,n],this.settings.openClass),a([this.settings.onClose,e]),this},toggle:function(e){return this.isOpen()?this.close(e):this.open(e)},isOpen:function(){return c(this.wrapper,this.settings.openClass)},addTrigger:function(e){var n=this,r=n.triggers,s=d(r,e),o=[e,function(e){l(e),n.toggle()}];return g(s)?r[s]=o:r.push(o),n.settings.enabled&&i(o[0],t,o[1]),n},removeTrigger:function(e){var n=this,r=n.triggers,s=d(r,e);return g(s)&&(o(r[s][0],t,r[s][1]),r.splice(s,1)),n},enable:function(){var e=this,n=e.triggers,r=n.length;if(!e.settings.enabled){e.settings.enabled=!0;for(var s=0;r>s;s++)i(n[s][0],t,n[s][1])}return e},disable:function(){var e=this,n=e.triggers,r=n.length;if(e.settings.enabled){e.settings.enabled=!1;for(var s=0;r>s;s++)o(n[s][0],t,n[s][1])}return e}}),s(v,{instances:{},extend:s,init:function(e,n){for(var t={},r=document.querySelectorAll(e),s=0;s<r.length;s++){var i=new this(r[s],n);this.instances[i.id]=t[s]=i}return void 0===t[1]?t[0]:t}}),window[e]=v}();
